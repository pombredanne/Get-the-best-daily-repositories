import{d as U,a7 as Ne,a8 as Re,a9 as de,aa as $e,a as r,b as v,e as s,z as C,t as I,B as V,m as x,f as d,u as t,_ as Q,J as q,F,p as G,V as fe,q as w,ab as be,i as Z,l as Y,c as S,r as b,P as ze,n as H,K as ne,ac as Se,ad as Ie,w as J,ae as ue,af as je,a4 as Pe,ag as ve,ah as le,o as te,ai as Me,x as K,k as ie,j as X,aj as Le,D as Fe,A as ce,G as Ue,H as Be,N as Ae,a3 as He,S as me,I as Oe,ak as ae,al as ge,am as Ge,T as Qe,an as Je}from"./index-181d502b.js";import{i as Ce}from"./index-408e81f4.js";import{N as ye}from"./InputNumber-77a5c1fb.js";import{N as we}from"./Switch-f64fe53e.js";import{N as Ke}from"./LayoutSider-60e3a614.js";import{N as We}from"./Drawer-a5d33987.js";import{c as De}from"./index-c94da121.js";import{b as qe}from"./mjDraw-4b87b82b.js";import{_ as Ze}from"./index.vue_vue_type_script_setup_true_lang-3fe19e5f.js";const re=U({name:"RadioButton",props:Ne,setup:Re,render(){const{mergedClsPrefix:e}=this;return de("label",{class:[`${e}-radio-button`,this.mergedDisabled&&`${e}-radio-button--disabled`,this.renderSafeChecked&&`${e}-radio-button--checked`,this.focus&&[`${e}-radio-button--focus`]]},de("input",{ref:"inputRef",type:"radio",class:`${e}-radio-input`,value:this.value,name:this.mergedName,checked:this.renderSafeChecked,disabled:this.mergedDisabled,onChange:this.handleRadioInputChange,onFocus:this.handleRadioInputFocus,onBlur:this.handleRadioInputBlur}),de("div",{class:`${e}-radio-button__state-border`}),$e(this.$slots.default,m=>!m&&!this.label?null:de("div",{ref:"labelRef",class:`${e}-radio__label`},m||this.label)))}}),Ye={class:"w-full mb-[15px]"},Xe={class:"flex items-center font-bold justify-between text-[14px]"},el={class:"flex items-center"},ll={class:"flex-1 text-right"},tl={class:"mt-[5px] mb-3"},P=U({__name:"subTitle",props:{title:null,tips:null,tipsWitdh:null},setup(e){return(m,a)=>(r(),v("div",Ye,[s("div",Xe,[s("div",el,[C(I(e.title)+" ",1),e.tips?(r(),V(t(fe),{key:0,placement:"right-end",trigger:"hover"},{trigger:x(()=>[d(t(Q),{icon:"ri:error-warning-line",class:"text-base cursor-pointer ml-2 mb-[2px] hover:text-primary"})]),default:x(()=>[s("div",{style:q({width:`${e.tipsWitdh}px`})},[(r(!0),v(F,null,G(e.tips,(l,i)=>(r(),v("p",{key:i},I(l),1))),128))],4)]),_:1})):w("",!0)]),s("div",ll,[be(m.$slots,"header")])]),s("div",tl,[be(m.$slots,"default")])]))}}),al=["accept"],sl={key:0,class:"absolute left-0 top-0 w-full h-full rounded"},nl=["src"],ol={class:"mask absolute left-0 top-0 w-full h-full flex justify-center items-center rounded"},ul={class:"absolute inset-0 flex items-center justify-center bg-gray-800 bg-opacity-50 rounded"},il=U({__name:"index",props:{modelValue:null,size:null},emits:["update:modelValue","selectSuccess","deleteBase"],setup(e,{emit:m}){const a=e,l=Z(),i=Y();S(()=>l.getToken),b("/api/upload/local");const o=b(null),n=S(()=>["image/png","image/jpg","image/jpeg","image/webp"].join(","));function c(f){return new Promise(A=>{var E;const{size:D,type:N}=f;if(f||i.error("未获取到文件信息！"),!["image/png","image/jpg","image/jpeg"].includes(N)&&!((E=a.uploadLimit)!=null&&E.includes("*"))){i.error("只能上传指定格式的文件！");return}if(D>1024*1024*5)return i.error("图片大小不能超过5M"),A(!1);A(!0)})}async function u(){try{const f=o.value.files[0];if(!await c(f))return;const D=new FileReader;D.onload=N=>{const L=N.target.result.toString();m("update:modelValue",L),m("selectSuccess",L)},D.readAsDataURL(f)}catch{i.error("上传资源失败！")}}function h(){m("update:modelValue",""),m("deleteBase")}function p(f){f.stopPropagation(),o.value.click()}return(f,A)=>(r(),v("span",{class:H([[e.modelValue?"border-none":"border-dashed"],"upload relative inline-block border dark:border-[#31353b] rounded overflow-hidden hover:border-primary dark:hover:border-primary hover:text-primary"]),style:q({width:`${e.size||100}px`,height:`${e.size||100}px`})},[s("span",null,[s("input",{id:"fileInputRef",ref_key:"fileInputRef",ref:o,accept:t(n),type:"file",style:{display:"none"},onClick:A[0]||(A[0]=ze(()=>{},["stop"])),onChange:u},null,40,al)]),e.modelValue?(r(),v("div",sl,[s("img",{src:e.modelValue,alt:"",class:"w-full h-full object-cover rounded"},null,8,nl)])):w("",!0),s("div",ol,[s("div",ul,[d(t(Q),{icon:"ep:delete",class:"uploadIcon text-[16px] text-white cursor-pointer",onClick:h})])]),e.modelValue?w("",!0):(r(),v("div",{key:1,class:"absolute left-0 top-0 w-full h-full bg-[#fafafc] dark:bg-[#272a30] flex justify-center items-center cursor-pointer",onClick:p},[be(f.$slots,"default",{},()=>[d(t(Q),{icon:"prime:upload",class:"uploadIcon text-[18px] text-gray-300"})],!0)]))],6))}});const oe=ne(il,[["__scopeId","data-v-2a83ab2b"]]),rl={class:"w-full flex flex-wrap"},Ee=U({__name:"uploadGroup",props:{modelValue:null,max:null,min:null},emits:["update:modelValue"],setup(e,{emit:m}){const l=b(e.modelValue),i=b("");function o(c){l.value.splice(c,1)}function n(c){l.value.push(c),m("update:modelValue",l.value),i.value=""}return(c,u)=>(r(),v("div",rl,[(r(!0),v(F,null,G(l.value,(h,p)=>(r(),V(oe,{key:p,modelValue:l.value[p],"onUpdate:modelValue":f=>l.value[p]=f,class:"mr-[5px] mb-[5px]",onDeleteBase:f=>o(p)},null,8,["modelValue","onUpdate:modelValue","onDeleteBase"]))),128)),l.value.length<e.max?(r(),V(oe,{key:0,modelValue:i.value,"onUpdate:modelValue":u[0]||(u[0]=h=>i.value=h),onDeleteBase:o,onSelectSuccess:n},null,8,["modelValue"])):w("",!0)]))}}),Te=e=>(Se("data-v-bbf920f7"),e=e(),Ie(),e),dl={class:"w-full space-y-1"},cl=["onClick"],pl={class:"whitespace-nowrap"},ml={class:"whitespace-nowrap h-[22px]"},fl=Te(()=>s("span",{class:"select-none"},"自定义",-1)),vl={class:"flex items-center h-[22px]"},hl=Te(()=>s("span",{class:"w-[40px] flex justify-center"},":",-1)),xl=U({__name:"drawScale",props:{modelValue:null},emits:["update:modelValue"],setup(e,{emit:m}){const a=e,l=b([[{label:"1:1",val:[1,1],text:"头像"},{label:"3:2",val:[3,2],text:"文章配图"},{label:"3:4",val:[3,4],text:"社交媒体"},{label:"4:3",val:[4,3],text:"公众号配图"},{label:"9:16",val:[9,16],text:"海报图"}],[{label:"16:9",val:[16,9],text:"电脑壁纸"},{label:"16:9",val:[1,2],custom:!0,text:"海报自定义图"}]]);function i(u,h){return u[0]===h[0]&&u[1]===h[1]}function o(u){const h=["text-primary border-primary  dark:border-[#b3e2fe]"];return["p-1 flex flex-col text-[12px] items-center justify-center rounded border transition-all select-none cursor-pointer  dark:border-[#9a9ca0] hover:border-primary hover:text-primary",i(u,a.modelValue)&&[...h]].join(" ")}function n(u){m("update:modelValue",u)}function c(u){return Ce(u)?u.toString():"1"}return(u,h)=>(r(),v("div",dl,[(r(!0),v(F,null,G(l.value,(p,f)=>(r(),v("div",{key:f,class:"flex space-x-1 items-stretch"},[(r(!0),v(F,null,G(p,A=>(r(),v("span",{key:A.val,class:"flex-1",onClick:D=>n(A.val)},[A.custom?(r(),v("span",{key:1,class:H(o(A.val))},[fl,s("div",vl,[d(t(ye),{value:A.val[0],"onUpdate:value":D=>A.val[0]=D,format:c,size:"small",class:"!h-[22px] text-center","show-button":!1},null,8,["value","onUpdate:value"]),hl,d(t(ye),{value:A.val[1],"onUpdate:value":D=>A.val[1]=D,format:c,size:"small",class:"!h-[22px] text-center","show-button":!1},null,8,["value","onUpdate:value"])])],2)):(r(),v("span",{key:0,class:H(o(A.val))},[s("span",pl,I(A.label),1),s("span",ml,I(A.text),1)],2))],8,cl))),128))]))),128))]))}});const bl=ne(xl,[["__scopeId","data-v-bbf920f7"]]),gl="/assets/niji-6eaa06b3.png",yl="/assets/mj-bd16de43.png",wl={class:"w-full flex space-x-2"},Al=["onClick"],_l={key:0,class:"absolute bottom-[8px] right-[8px] z-10"},kl=s("div",{class:"w-0 h-0 border-solid border-b-8 border-r-8 border-transparent"},null,-1),Vl=s("div",{class:"absolute top-0 left-0 w-full h-full flex items-center justify-center"},[s("span",{class:"text-lg font-bold text-primary"},"✔")],-1),Sl=[kl,Vl],Il=["src"],Ul={class:"absolute inset-0 flex items-center justify-center select-none bg-gray-800 bg-opacity-70 flex-col hover:bg-opacity-10 transition-all"},Bl={class:"font-bold"},Cl=U({__name:"drawModelType",props:{modelValue:null},emits:["update:modelValue"],setup(e,{emit:m}){const a=e,l=b([{label:"Midjourney",tips:"真实风格",value:"mj",bg:yl},{label:"Niji",tips:"动漫风格",value:"niji",bg:gl}]);function i(n){return["relative rounded-md overflow-hidden bordercursor-pointer",n===a.modelValue?"text-white border-primary ":"text-white font-semibold border-transparent"]}function o(n){m("update:modelValue",n)}return(n,c)=>(r(),v("div",wl,[(r(!0),v(F,null,G(l.value,u=>(r(),v("div",{key:u.value,class:H(["relative rounded-md overflow-hidden border cursor-pointer",i(u.value)]),onClick:h=>o(u.value)},[u.value===e.modelValue?(r(),v("div",_l,Sl)):w("",!0),s("img",{src:u.bg,alt:"Your Image",class:"w-full h-auto"},null,8,Il),s("div",Ul,[s("span",Bl,I(u.label),1),s("span",null,I(u.tips),1)])],10,Al))),128))]))}}),Dl=U({__name:"drawVersion",props:{modelValue:null,modelType:null},emits:["update:modelValue"],setup(e,{emit:m}){const a=e,l=b(""),i=S(()=>a.modelType==="mj"?[{label:"V6",value:"6.0"},{label:"V5.2",value:"5.2"},{label:"V5.1",value:"5.1"},{label:"V5",value:"5"},{label:"V4",value:"4"}]:a.modelType==="niji"?[{label:"V6",value:"6"},{label:"V5",value:"5"}]:[]);function o(n){l.value=n,m("update:modelValue",l.value)}return J(()=>a.modelType,()=>{i.value.length?l.value=i.value[0].value:l.value="",m("update:modelValue",l.value)},{immediate:!0}),(n,c)=>(r(),V(t(ue),{value:l.value,"onUpdate:value":c[0]||(c[0]=u=>l.value=u),size:"small","on-update:value":o,name:"radiogroup"},{default:x(()=>[(r(!0),v(F,null,G(t(i),u=>(r(),V(t(re),{key:u.value,class:"text-[12px] font-normal",value:u.value,label:u.label},null,8,["value","label"]))),128))]),_:1},8,["value"]))}}),El=U({__name:"drawQuality",props:{modelValue:null},emits:["update:modelValue"],setup(e,{emit:m}){const a=e,l=b(""),i=b([{label:"普通",value:".25"},{label:"一般",value:".5"},{label:"高清",value:"1"},{label:"超高清",value:"2"}]);function o(n){l.value=n,m("update:modelValue",l.value)}return J(()=>a.modelValue,()=>{l.value=a.modelValue},{immediate:!0}),(n,c)=>(r(),V(t(ue),{value:l.value,"onUpdate:value":c[0]||(c[0]=u=>l.value=u),size:"small","on-update:value":o,name:"radiogroup"},{default:x(()=>[(r(!0),v(F,null,G(i.value,u=>(r(),V(t(re),{key:u.value,class:"text-[12px] font-normal",value:u.value,label:u.label},null,8,["value","label"]))),128))]),_:1},8,["value"]))}}),Tl=U({__name:"drawInputNumber",props:{modelValue:null,max:null,min:null,defaultNull:{type:Boolean},clearable:{type:Boolean},notShowButton:{type:Boolean},step:null},emits:["update:modelValue"],setup(e,{emit:m}){const a=e,l=b(0);function i(n){return Ce(n)?n.toString():a.defaultNull?null:"1"}function o(n){l.value=n,m("update:modelValue",l.value)}return J(()=>a.modelValue,()=>{l.value=a.modelValue},{immediate:!0}),(n,c)=>(r(),V(t(ye),{value:l.value,"onUpdate:value":c[0]||(c[0]=u=>l.value=u),step:e.step,clearable:e.clearable,min:e.min,max:e.max,"show-button":!e.notShowButton,format:i,size:"small",class:"!h-[22px] text-[12px] font-normal text-center","on-update:value":o},null,8,["value","step","clearable","min","max","show-button"]))}});const pe=ne(Tl,[["__scopeId","data-v-044018a7"]]),Nl=U({__name:"drawSlider",props:{modelValue:null,max:null,min:null},emits:["update:modelValue"],setup(e,{emit:m}){const a=e,l=b(0);function i(o){l.value=o,m("update:modelValue",l.value)}return J(()=>a.modelValue,()=>{l.value=a.modelValue},{immediate:!0}),(o,n)=>(r(),V(t(je),{value:l.value,"onUpdate:value":n[0]||(n[0]=c=>l.value=c),type:"primary",step:1,tooltip:!1,min:e.min,max:e.max,"on-update:value":i,class:"!py-3"},null,8,["value","min","max"]))}});const xe=ne(Nl,[["__scopeId","data-v-f5c96076"]]),se=U({__name:"drawSelect",props:{modelValue:null,dataList:null,placeholder:null},emits:["update:modelValue"],setup(e,{emit:m}){const a=e,l=b(null);function i(o){l.value=o,m("update:modelValue",l.value)}return J(()=>a.modelValue,()=>{l.value=a.modelValue},{immediate:!0}),(o,n)=>(r(),V(t(Pe),{value:l.value,"onUpdate:value":n[0]||(n[0]=c=>l.value=c),placeholder:e.placeholder,size:"small",options:e.dataList,"on-update:value":i},null,8,["value","placeholder","options"]))}}),Rl=U({__name:"drawStyle",props:{modelValue:null},emits:["update:modelValue"],setup(e,{emit:m}){const a=e,l=b(""),i=[{label:"默认",value:0},{label:"表现力",value:"expressive"},{label:"可爱",value:"cute"},{label:"景观",value:"scenic"}];function o(n){l.value=n,m("update:modelValue",l.value)}return J(()=>a.modelValue,()=>{l.value=a.modelValue},{immediate:!0}),(n,c)=>(r(),V(t(ue),{value:l.value,"onUpdate:value":c[0]||(c[0]=u=>l.value=u),size:"small","on-update:value":o,name:"radiogroup"},{default:x(()=>[(r(),v(F,null,G(i,u=>d(t(re),{key:u.value,class:"text-[12px] font-normal",value:u.value,label:u.label},null,8,["value","label"])),64))]),_:1},8,["value"]))}});function $l(e){return ve({url:"/draw/recSysList",data:e})}function zl(e){return ve({url:"/draw/mineList",data:e})}function jl(e){return ve({url:"/draw/detail",data:e})}function Pl(){return ve({url:"/draw/notice"})}function Ml(e){return le({url:"/draw/textToImage",data:e})}function Ll(e){return le({url:"/draw/drawAction",data:e})}function Fl(e){return le({url:"/draw/delItem",data:e})}function Hl(e){return le({url:"/draw/swapFace",data:e})}function Ol(e){return le({url:"/draw/drawBlend",data:e})}function Gl(e){return le({url:"/draw/seed",data:e})}function Ql(e){return le({url:"/draw/describe",data:e})}const Jl={class:"w-full h-full p-[15px]"},Kl=["innerHTML"],Wl={class:"flex items-end justify-end"},ql=s("span",{class:"whitespace-nowrap text-[12px] mr-1 font-normal"},"当前程度：",-1),Zl={class:"flex items-end justify-end"},Yl=s("span",{class:"whitespace-nowrap text-[12px] mr-1 font-normal"},"当前程度：",-1),Xl={class:"flex items-end justify-end"},et={class:"flex items-end justify-end"},lt={class:"mt-5 mb-2 font-bold text-[16px] flex items-center"},tt=s("div",null," 参考图、数量最多五张 ",-1),at={class:"flex items-end justify-end"},st=s("span",{class:"whitespace-nowrap text-[12px] mr-1 font-normal"},"当前程度：",-1),nt=s("h3",{class:"mt-5 mb-2 font-bold text-[16px]"}," 辅助提示 ",-1),ot=U({__name:"textToImage",emits:["notice"],setup(e,{emit:m}){const a=b(""),l=b({taskType:1,scale:[9,16],model:"mj",version:"",quality:"1",chaos:0,stylize:0,style:"",view:null,cameraShot:null,light:null,seed:null,referencePic:[],iw:0,no:"",customInstruct:!1}),i=[{label:"宽景",value:"Wide view"},{label:"鸟瞰",value:"Bird view"},{label:"俯视",value:"Top view"},{label:"仰视",value:"Upview"},{label:"正面",value:"Front view"},{label:"头部特写",value:"Headshot"},{label:"超广角",value:"Ultrawideshot"},{label:"中景",value:"Medium Shot(MS)"},{label:"远景",value:"Long Shot(LS)"},{label:"景深",value:"depth offield(dof)"}],o=[{label:"脸部特写",value:"Face Shot (VCU)"},{label:"头部以上",value:"Big Close-Up(BCU)"},{label:"颈部以上",value:"Close-Up(CU)"},{label:"腰部以上",value:"Waist Shot(WS)"},{label:"膝盖以上",value:"KneeShot(KS)"},{label:"全身",value:"Full Length Shot(FLS)"},{label:"人在远方",value:"Extra Long Shot(ELS)"}],n=[{label:"冷光",value:"Cold light"},{label:"暖光",value:"Warm light"},{label:"强光",value:"hard lighting"},{label:"戏剧光",value:"Dramatic light"},{label:"反光",value:"reflection light"},{label:"雾气朦胧",value:"Misty foggy"},{label:"自然光",value:"Natural light"},{label:"太阳光",value:"Sun light"},{label:"暗黑的",value:"moody"}],c=S(()=>a.value?Me(a.value):"");async function u(){const h=await Pl();a.value=h==null?void 0:h.data}return te(()=>{m("notice",l.value),u()}),(h,p)=>(r(),v("div",Jl,[t(c)?(r(),v("div",{key:0,class:"w-full h-full bg-[#f2f3f9] dark:bg-[#31353B] rounded-md mb-2 p-2 text-[12px] text-black dark:text-white",innerHTML:t(c)},null,8,Kl)):w("",!0),d(P,{title:"模型选择",tips:["MJ: 偏真实通用模型","NIJI: 偏动漫风格、适用于二次元模型"]},{default:x(()=>[d(Cl,{modelValue:l.value.model,"onUpdate:modelValue":p[0]||(p[0]=f=>l.value.model=f)},null,8,["modelValue"])]),_:1}),d(P,{title:"版本"},{header:x(()=>[d(Dl,{modelValue:l.value.version,"onUpdate:modelValue":p[1]||(p[1]=f=>l.value.version=f),"model-type":l.value.model},null,8,["modelValue","model-type"])]),default:x(()=>[d(P,{title:"图片比例",tips:["参数释义：生成图片尺寸比例"]},{default:x(()=>[d(bl,{modelValue:l.value.scale,"onUpdate:modelValue":p[2]||(p[2]=f=>l.value.scale=f)},null,8,["modelValue"])]),_:1})]),_:1}),d(P,{title:"品质"},{header:x(()=>[d(El,{modelValue:l.value.quality,"onUpdate:modelValue":p[3]||(p[3]=f=>l.value.quality=f)},null,8,["modelValue"])]),_:1}),l.value.model==="niji"&&l.value.version==="5"?(r(),V(P,{key:1,title:"风格"},{header:x(()=>[d(Rl,{modelValue:l.value.style,"onUpdate:modelValue":p[4]||(p[4]=f=>l.value.style=f)},null,8,["modelValue"])]),_:1})):w("",!0),d(P,{title:"混乱程度",tips:["取值范围：0-100、 --chaos 或 --c","混乱级别，可以理解为让AI天马行空的空间","值越小越可靠、默认0最为精准"]},{header:x(()=>[s("div",Wl,[ql,d(pe,{modelValue:l.value.chaos,"onUpdate:modelValue":p[5]||(p[5]=f=>l.value.chaos=f),min:0,max:100,class:"w-[90px]"},null,8,["modelValue"])])]),default:x(()=>[d(xe,{modelValue:l.value.chaos,"onUpdate:modelValue":p[6]||(p[6]=f=>l.value.chaos=f),min:0,max:100},null,8,["modelValue"])]),_:1}),d(P,{title:"风格化程度","tips-witdh":240,tips:["风格化：--stylize 或 --s，范围 1-1000参数释义：数值越高，画面表现也会更具丰富性和艺术性"]},{header:x(()=>[s("div",Zl,[Yl,d(pe,{modelValue:l.value.stylize,"onUpdate:modelValue":p[7]||(p[7]=f=>l.value.stylize=f),min:0,max:1e3,class:"w-[90px]"},null,8,["modelValue"])])]),default:x(()=>[d(xe,{modelValue:l.value.stylize,"onUpdate:modelValue":p[8]||(p[8]=f=>l.value.stylize=f),min:0,max:1e3},null,8,["modelValue"])]),_:1}),d(P,{"tips-witdh":200,title:"Seed",tips:["种子数是为每个图像随机生成的，如果您使用相同的种子号和提示，您将获得相似的最终图像。范围为0–4294967295的整数。","您可以在右侧找到喜欢的图片获取到此值！"]},{header:x(()=>[s("div",Xl,[d(pe,{modelValue:l.value.seed,"onUpdate:modelValue":p[9]||(p[9]=f=>l.value.seed=f),"not-show-button":"","default-null":"",clearable:"",min:0,max:4294967295,class:"w-[155px]"},null,8,["modelValue"])])]),_:1}),d(P,{"tips-witdh":320,title:"禁用指令",tips:["开启后选项中的配置参数将不会携带，您可以在描述中进行自定义参数指定。","反之不打开、自定义输入--指令将会被忽略覆盖。","开启后不会翻译与优化咒语！"]},{header:x(()=>[s("div",et,[d(t(we),{value:l.value.customInstruct,"onUpdate:value":p[10]||(p[10]=f=>l.value.customInstruct=f)},null,8,["value"])])]),_:1}),s("h3",lt,[C(" 垫图生图 "),d(t(fe),{placement:"right-end",trigger:"hover"},{trigger:x(()=>[d(t(Q),{icon:"ri:error-warning-line",class:"text-base cursor-pointer ml-2 mb-[2px] hover:text-primary"})]),default:x(()=>[tt]),_:1})]),d(Ee,{modelValue:l.value.referencePic,"onUpdate:modelValue":p[11]||(p[11]=f=>l.value.referencePic=f),max:5,class:"mb-3"},null,8,["modelValue"]),d(P,{title:"参考图权重",tips:["数值越大对绘制结果影响越大"]},{header:x(()=>[s("div",at,[st,d(pe,{modelValue:l.value.iw,"onUpdate:modelValue":p[12]||(p[12]=f=>l.value.iw=f),min:0,max:2,step:.01,class:"w-[90px]"},null,8,["modelValue","step"])])]),default:x(()=>[d(xe,{modelValue:l.value.iw,"onUpdate:modelValue":p[13]||(p[13]=f=>l.value.iw=f),step:.01,min:0,max:2},null,8,["modelValue","step"])]),_:1}),nt,d(P,{title:"视角"},{default:x(()=>[d(se,{modelValue:l.value.view,"onUpdate:modelValue":p[14]||(p[14]=f=>l.value.view=f),"data-list":i,placeholder:"视角选择"},null,8,["modelValue"])]),_:1}),d(P,{title:"人物镜头"},{default:x(()=>[d(se,{modelValue:l.value.cameraShot,"onUpdate:modelValue":p[15]||(p[15]=f=>l.value.cameraShot=f),"data-list":o,placeholder:"镜头选择"},null,8,["modelValue"])]),_:1}),d(P,{title:"灯光"},{default:x(()=>[d(se,{modelValue:l.value.light,"onUpdate:modelValue":p[16]||(p[16]=f=>l.value.light=f),"data-list":n,placeholder:"灯光选择"},null,8,["modelValue"])]),_:1})]))}}),ut={class:"w-full h-full p-[14px] relative"},it={class:"flex justify-end"},rt={class:"flex justify-center w-full mt-8 pr-5"},dt=s("div",{class:"mt-5 space-y-1"},[s("h3",{class:"font-semibold"}," 使用说明 "),s("p",null,"- 混图需要2-6张图片、请注意张数"),s("p",null,"- 单张图片大小不可大于5M"),s("p",null,"- 图片顺序越前，权重越高"),s("p",null,"- 建议把你最想融合的图片放在最前面")],-1),ct=U({__name:"blendImage",emits:["notice","submitNotice"],setup(e,{emit:m}){const a=Z();S(()=>a.isLogin);const l=Y(),i=b(!1),o=b({taskType:2,base64Arr:[],dimensions:"PORTRAIT"}),n=b([{label:"广场 SQUARE (1:1)",value:"SQUARE"},{label:"肖像 PORTRAIT(2:3)",value:"PORTRAIT"},{label:"景观 LANDSCAPE(3:2)",value:"LANDSCAPE"}]);async function c(){try{if(i.value=!0,o.value.base64Arr.length<2&&o.value.base64Arr.length>6){l.error("混合图片需要2-6张图片");return}await Ol(o.value),i.value=!1,m("submitNotice"),a.getUserInfo()}catch{i.value=!1}}return te(()=>{m("notice",o.value)}),(u,h)=>(r(),v("div",ut,[d(P,{title:"视角",tips:["混合后的图片的尺寸"]},{header:x(()=>[s("div",it,[d(se,{modelValue:o.value.dimensions,"onUpdate:modelValue":h[0]||(h[0]=p=>o.value.dimensions=p),"data-list":n.value,placeholder:"尺寸选择",class:"!w-[200px]"},null,8,["modelValue","data-list"])])]),_:1}),d(P,{title:"混合图片",tips:["混合图片最少需要两张图片","混合图片最多支持六张图"]},{default:x(()=>[d(Ee,{modelValue:o.value.base64Arr,"onUpdate:modelValue":h[1]||(h[1]=p=>o.value.base64Arr=p),tips:["图片最少两张、最多六张"],max:6,class:"mb-3"},null,8,["modelValue"])]),_:1}),s("div",rt,[d(t(K),{size:"small",type:"primary",loading:i.value,disabled:i.value||o.value.base64Arr.length<2,onClick:c},{default:x(()=>[C(I(i.value?"正在提交...":"提交混合任务"),1)]),_:1},8,["loading","disabled"])]),dt]))}}),pt={class:"w-full h-full p-[14px]"},mt={class:"flex justify-around items-center"},ft=s("span",{class:"text-gray-400"},"您的头像",-1),vt=s("span",{class:"text-gray-400"},"明星图",-1),ht={class:"flex justify-center w-full mt-8 pr-5"},xt=s("div",{class:"mt-5 space-y-1"},[s("h3",{class:"font-semibold"}," 使用说明 "),s("p",null,"- 请注意图片都须包含人脸、否则可能出图异常"),s("p",null,"- 你的头像：建议用一寸个人照效果更佳"),s("p",null,"- 明星图：也可以通过mj绘制出来之后使用"),s("p",null,"- 单张图片大小不可大于5M")],-1),bt=U({__name:"swapFace",emits:["notice","submitNotice"],setup(e,{emit:m}){const a=Z();S(()=>a.isLogin);const l=Y(),i=b(!1),o=b({taskType:3,sourceBase:"",targetBase:""});te(()=>{m("notice",o.value)});async function n(){try{if(i.value=!0,!o.value.sourceBase||!o.value.targetBase){l.error("请上传两张图片");return}await Hl(o.value),i.value=!1,m("submitNotice"),l.success("提交成功"),a.getUserInfo()}catch{i.value=!1}}return(c,u)=>(r(),v("div",pt,[s("div",mt,[d(oe,{modelValue:o.value.sourceBase,"onUpdate:modelValue":u[0]||(u[0]=h=>o.value.sourceBase=h),size:140},{default:x(()=>[ft]),_:1},8,["modelValue"]),C(" + "),d(oe,{modelValue:o.value.targetBase,"onUpdate:modelValue":u[1]||(u[1]=h=>o.value.targetBase=h),size:140},{default:x(()=>[vt]),_:1},8,["modelValue"])]),s("div",ht,[d(t(K),{size:"small",type:"primary",loading:i.value,disabled:i.value||!o.value.targetBase||!o.value.sourceBase,onClick:n},{default:x(()=>[C(I(i.value?"正在提交...":"提交换脸任务"),1)]),_:1},8,["loading","disabled"])]),xt]))}}),gt=U({__name:"drawQualityDalle",props:{modelValue:null},emits:["update:modelValue"],setup(e,{emit:m}){const a=e,l=b(""),i=[{label:"标准质量",value:"standard"},{label:"优质质量",value:"hd"}];function o(n){l.value=n,m("update:modelValue",l.value)}return J(()=>a.modelValue,()=>{l.value=a.modelValue},{immediate:!0}),(n,c)=>(r(),V(t(ue),{value:l.value,"onUpdate:value":c[0]||(c[0]=u=>l.value=u),size:"small","on-update:value":o,name:"radiogroup"},{default:x(()=>[(r(),v(F,null,G(i,u=>d(t(re),{key:u.value,class:"text-[12px] font-normal",value:u.value,label:u.label},null,8,["value","label"])),64))]),_:1},8,["value"]))}}),yt=U({__name:"drawStyleDalle",props:{modelValue:null},emits:["update:modelValue"],setup(e,{emit:m}){const a=e,l=b(""),i=[{label:"真实风格",value:"vivid"},{label:"自然风格",value:"natural"}];function o(n){l.value=n,m("update:modelValue",l.value)}return J(()=>a.modelValue,()=>{l.value=a.modelValue},{immediate:!0}),(n,c)=>(r(),V(t(ue),{value:l.value,"onUpdate:value":c[0]||(c[0]=u=>l.value=u),size:"small","on-update:value":o,name:"radiogroup"},{default:x(()=>[(r(),v(F,null,G(i,u=>d(t(re),{key:u.value,class:"text-[12px] font-normal",value:u.value,label:u.label},null,8,["value","label"])),64))]),_:1},8,["value"]))}}),wt={class:"w-full h-full p-[14px]"},At={class:"flex justify-end"},_t={class:"flex justify-end"},kt={class:"flex justify-end"},Vt={class:"flex justify-end"},St=U({__name:"dalle",emits:["notice"],setup(e,{emit:m}){const a=b({taskType:4,model:"dall",version:"3",scale:"1024x1024",quality:"standard",style:"vivid"}),l=S(()=>Number(a.value.version)===3?[{label:"1024px*1024px",value:"1024x1024"},{label:"1024px*1792px",value:"1024x1792"},{label:"1792px*1024px",value:"1792x1024"}]:[{label:"1024px*1024px",value:"1024x1024"},{label:"512px*512px",value:"512*512"},{label:"256px*256px",value:"256x256"}]),i=[{label:"Dall.E 3",value:"3"},{label:"Dall.E 2",value:"2"}];return J(()=>a.value.version,()=>{a.value.scale="1024x1024"}),te(()=>{m("notice",a.value)}),(o,n)=>(r(),v("div",wt,[d(P,{title:"版本",tips:["Dall.E 版本选择"]},{header:x(()=>[s("div",At,[d(se,{modelValue:a.value.version,"onUpdate:modelValue":n[0]||(n[0]=c=>a.value.version=c),"data-list":i,placeholder:"尺寸选择",class:"!w-[185px]"},null,8,["modelValue"])])]),_:1},8,["tips"]),d(P,{title:"尺寸",tips:["更大尺寸价格更贵"]},{header:x(()=>[s("div",_t,[d(se,{modelValue:a.value.scale,"onUpdate:modelValue":n[1]||(n[1]=c=>a.value.scale=c),"data-list":t(l),placeholder:"尺寸选择",class:"!w-[185px]"},null,8,["modelValue","data-list"])])]),_:1}),Number(a.value.version)===3?(r(),V(P,{key:0,title:"质量",tips:["生成图片的质量"]},{header:x(()=>[s("div",kt,[d(gt,{modelValue:a.value.quality,"onUpdate:modelValue":n[2]||(n[2]=c=>a.value.quality=c)},null,8,["modelValue"])])]),_:1})):w("",!0),Number(a.value.version)===3?(r(),V(P,{key:1,title:"风格",tips:["选择您喜欢的风格把"]},{header:x(()=>[s("div",Vt,[d(yt,{modelValue:a.value.style,"onUpdate:modelValue":n[3]||(n[3]=c=>a.value.style=c)},null,8,["modelValue"])])]),_:1})):w("",!0)]))}}),It="data:image/png;base64,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",Ut={class:"absolute w-full bg-white dark:bg-[#1f1f1f] rounded-b-md h-[50px] bottom-0 border-t border-[#eaebef] dark:border-[#404752] flex items-center justify-between px-4"},Bt={class:"text-[14px] py-1 flex items-center"},Ct=["src"],Dt={class:"text-[#3076fd]"},Et={class:"flex items-center"},Tt=U({__name:"index",emits:["notice","submitNotice"],setup(e,{emit:m}){const a=Z(),l=b(!1),i=ie(),o=S(()=>i.siderDrawCollapsed),{isMobile:n}=X(),c=S(()=>n.value?{position:"fixed",zIndex:50}:{backgroundColor:"#000"}),u=S(()=>a.userBalance),h=S(()=>u.value.sumDrawMjCount||0);function p(){i.setSiderDrawCollapsed(!o.value)}function f(N){m("notice",N)}function A(){m("submitNotice")}async function D(){l.value=!0;try{await a.getUserInfo(),l.value=!1}catch{l.value=!1}}return Le(()=>{n.value&&i.setSiderDrawCollapsed(!0)}),(N,L)=>(r(),v(F,null,[d(t(Ke),{collapsed:t(o),"collapsed-width":0,width:350,"show-trigger":t(n)?!1:"arrow-circle","collapse-mode":"transform",position:"absolute",bordered:"",style:q(t(c)),"content-style":{backgroundColor:t(i).theme==="dark"?"#1f1f1f":"#dce3f1"},onUpdateCollapsed:p},{default:x(()=>[s("div",{class:H(["bg-white dark:bg-[#1f1f1f] min-h-full rounded-md pb-[80px]",t(n)?"mt-[45px] border-t dark:border-[#404752]":""])},[d(t(Fe),{"default-value":"textToImgae","justify-content":"space-evenly",type:"line"},{default:x(()=>[d(t(ce),{name:"textToImgae",tab:"文生图"},{default:x(()=>[d(ot,{onNotice:f})]),_:1}),d(t(ce),{name:"blend",tab:"混图"},{default:x(()=>[d(ct,{onNotice:f,onSubmitNotice:A})]),_:1}),d(t(ce),{name:"swapFace",tab:"换脸"},{default:x(()=>[d(bt,{onNotice:f,onSubmitNotice:A})]),_:1}),d(t(ce),{name:"DallE",tab:"Dall.E"},{default:x(()=>[d(St,{onNotice:f})]),_:1})]),_:1})],2),s("div",Ut,[s("span",Bt,[s("img",{src:t(It),class:"w-[16px] mr-1 mb-1"},null,8,Ct),C(" 钱包余额("),s("b",Dt,I(t(h)||0),1),C(" 积分)")]),s("span",Et,[d(t(K),{text:"",size:"tiny",type:"primary",loading:l.value,onClick:D},{default:x(()=>[C("刷新")]),_:1},8,["loading"]),d(t(fe),{placement:"top",trigger:"hover"},{trigger:x(()=>[d(t(Q),{icon:"ri:error-warning-line",class:"text-base ml-2"})]),default:x(()=>[C(" 绘画账户信息 ")]),_:1})])])]),_:1},8,["collapsed","show-trigger","style","content-style"]),t(n)?Ue((r(),v("div",{key:0,class:"fixed inset-0 z-10 bg-black/40",onClick:p},null,512)),[[Be,!t(o)]]):w("",!0)],64))}}),Nt={key:0,class:"px-[18px] py-[10px] bg-white dark:bg-[#1f1f1f] z-10 bg-transparent rounded-b-md"},Rt={class:"relative flex-1"},$t={class:"absolute bottom-2 left-2 right-2"},zt={class:"flex items-center justify-between"},jt={class:"flex space-x-5"},Pt={class:"flex items-center"},Mt=s("span",{class:"w-[1px] h-[12px] bg-gray-400 mx-2"},null,-1),Lt={class:"flex items-center"},Ft=s("span",{class:"w-[1px] h-[12px] bg-gray-400 mx-2"},null,-1),Ht={class:"flex justify-between items-center"},Ot={class:"dark:text-black"},Gt={class:"dark:text-black"},Qt={class:"w-[200px] h-full rounded-md flex p-3"},Jt={class:"flex flex-col w-full"},Kt=s("h4",{class:"mb-2"}," 咒语解析 ",-1),Wt={class:"flex flex-col justify-center items-center w-full"},qt=U({__name:"inputBox",props:{notifyId:null,submitLoading:{type:Boolean},params:null},emits:["submit","update"],setup(e,{emit:m}){const a=e,l=b(""),i=b(!1),o=He(),{isMobile:n}=X(),c=b(""),u=b("fast"),h=b(!1),p=b(!0),f=ie(),A=b(!1);async function D(){var M;const g=o.query.drawId;if(!g)return;const B=await jl({id:g});c.value=(M=B==null?void 0:B.data)==null?void 0:M.prompt}const N=S(()=>c.value===""||a.submitLoading);J(()=>a.notifyId,()=>{c.value=""});async function L(){try{A.value=!0,await Ql({base64:l.value}),l.value="",A.value=!1,i.value=!1,m("update")}catch{A.value=!1}}function E(g){n.value?g.key==="Enter"&&g.ctrlKey&&(g.preventDefault(),R()):g.key==="Enter"&&!g.shiftKey&&(g.preventDefault(),R())}te(()=>{D()});function z(){f.setSiderDrawCollapsed(!1)}function R(){m("submit",{prompt:c.value,autoOptimize:h.value,autoTranslate:p.value,speed:u.value})}function _(){i.value=!0}return(g,B)=>[1,4].includes(e.params.taskType)?(r(),v("div",Nt,[s("div",{id:"drawer-target",class:"w-[200px] mb-2 rounded-md float-right",style:q([{position:"relative","margin-top":"10px",display:"flex","align-items":"center","justify-content":"center",overflow:"hidden"},{height:i.value?"200px":"0px"}])},null,4),s("div",Rt,[d(t(Ae),{ref:"inputRef",value:c.value,"onUpdate:value":B[0]||(B[0]=M=>c.value=M),type:"textarea",class:"pb-10",clearable:"",disabled:e.submitLoading,autofocus:"",placeholder:"发挥您的想象力、输入您想要生成的图片描述信息......",autosize:{minRows:t(n)?1:2,maxRows:t(n)?2:3},onKeypress:E},null,8,["value","disabled","autosize"]),s("div",$t,[s("div",zt,[s("div",jt,[t(n)?(r(),v("span",{key:0,class:"text-2xl bg-[#6790f4] text-white shadow p-1 ml-1 mr-1 rounded-full",onClick:z},[d(t(Q),{class:"text-[14px]",icon:"ep:expand"})])):w("",!0),s("span",Pt,[d(t(we),{value:h.value,"onUpdate:value":B[1]||(B[1]=M=>h.value=M),size:"small"},null,8,["value"]),C(),Mt,C(" "+I(t(n)?"优化":"自动优化提示词"),1)]),s("span",Lt,[d(t(we),{value:p.value,"onUpdate:value":B[2]||(B[2]=M=>p.value=M),size:"small"},null,8,["value"]),C(),Ft,C(" "+I(t(n)?"翻译":"自动翻译"),1)]),t(n)?w("",!0):(r(),V(t(K),{key:1,type:"primary",size:"small",ghost:"",onClick:_},{default:x(()=>[d(t(Q),{class:"text-[20px] mr-1 mb-[2px]",icon:"mage:light-bulb"}),C(" 咒语解析 ")]),_:1})),t(n)?(r(),V(t(Q),{key:2,class:"text-[20px] mr-1 mb-[2px]",icon:"mage:light-bulb",onClick:_})):w("",!0)]),s("div",Ht,[e.submitLoading?w("",!0):(r(),V(t(K),{key:0,type:"primary",size:"small",style:{padding:"0px",width:"28px",height:"28px",border:"0px"},disabled:t(N),round:"",onClick:R},{icon:x(()=>[s("span",Ot,[d(t(Q),{icon:"icon-park-outline:send"})])]),_:1},8,["disabled"])),e.submitLoading?(r(),V(t(K),{key:1,type:"primary",size:"small",style:{padding:"0px",width:"28px",height:"28px",border:"0px"},disabled:t(N),round:""},{icon:x(()=>[s("span",Gt,[d(t(Q),{icon:"eos-icons:loading",class:"text-[22px]"})])]),_:1},8,["disabled"])):w("",!0)])])])]),d(t(We),{show:i.value,"onUpdate:show":B[4]||(B[4]=M=>i.value=M),height:200,placement:"bottom","trap-focus":!1,"block-scroll":!1,"show-mask":!1,to:"#drawer-target"},{default:x(()=>[s("div",Qt,[s("div",Jt,[Kt,s("div",Wt,[d(oe,{modelValue:l.value,"onUpdate:modelValue":B[3]||(B[3]=M=>l.value=M),size:120,class:"flex-shrink-0"},null,8,["modelValue"]),d(t(K),{size:"small",type:"primary",disabled:!l.value,class:"!mt-2 !text-[12px] !h-[22px] !w-[118px]",loading:A.value,onClick:L},{default:x(()=>[C(" 解析 ")]),_:1},8,["disabled","loading"])])])])]),_:1},8,["show"])])):w("",!0)}});function Zt(e,m){let a=!1;return function(){a||(e(),a=!0,setTimeout(()=>{a=!1},m))}}function Yt(){const e=b(null),m=async()=>{await me(),e.value&&(e.value.scrollTop=e.value.scrollHeight)},a=async()=>{await me(),e.value&&(e.value.scrollTop=0)},l=Zt(i,100);async function i(){e.value&&e.value.scrollHeight-e.value.scrollTop-e.value.clientHeight<=500&&(e.value.scrollTop=e.value.scrollHeight)}return{scrollRef:e,scrollToBottom:m,scrollToTop:a,scrollToBottomIfAtBottom:l}}const Xt={class:"flex min-h-[65px] border-l-2 border-[#d03050]"},ea={class:"flex flex-col justify-between bg-[#fbeef1] dark:bg-[#404752] px-[20px] py-[4px] rounded-r-md min-w-[250px]"},la={class:"text-[16px] font-medium"},ta={class:"text-[14px]"},ke=U({__name:"errPanel",props:{errMsg:null},setup(e){const m=e,a=S(()=>l(m.errMsg));function l(i){const o=i.match(/\[(.*?)\]/),n=i.match(/\] (.*)/),c=o?o[1]:"",u=n?n[1]:"";return{title:c,text:u}}return(i,o)=>{var n,c;return r(),v("div",Xt,[s("div",ea,[s("span",la,I(((n=t(a))==null?void 0:n.title)||"draw err"),1),s("span",ta,I(((c=t(a))==null?void 0:c.text)||m.errMsg||"出现了一点儿小错误！"),1)])])}}}),aa={class:"w-[300px]"},sa=U({__name:"loadingImg",props:{url:null,preUrl:null,scale:null},setup(e){const m=e,a=ie(),l=b(!1),{isMobile:i}=X();function o(){l.value=!0}const n=S(()=>i?260:300),c=S(()=>{const u=m.scale||"1:1",[h,p]=u.split(":").map(Number);return n.value*p/h});return(u,h)=>(r(),v("div",aa,[Ue(d(t(Oe),{width:t(n),src:e.url,"on-load":o,"preview-src":e.preUrl},null,8,["width","src","preview-src"]),[[Be,l.value]]),l.value?w("",!0):(r(),v("div",{key:0,style:q({width:`${t(n)}px`,height:`${t(c)}px`}),class:H(["relative",t(a).theme==="dark"?"loadBg-dark":"loadBg-light"])},[s("span",{style:q({left:`${t(n)-37}px`}),class:"absolute top-2 bg-white rounded-full p-[2px]"},[d(t(Q),{icon:"line-md:loading-alt-loop",class:"text-[24px] text-primary"})],4)],6))]))}});const na=ne(sa,[["__scopeId","data-v-36627085"]]),oa={key:0},ua=s("p",{class:"my-2"}," 下列咒语是由你解析的提示词、你可以选择喜欢的提示词、复制到输入框、如果有自定义指令、请在左侧禁用自定义指令！ ",-1),ia=["onClick"],ra=U({__name:"describePre",props:{detail:null},setup(e){const m=e,a=Y(),l=S(()=>{let o=[];try{o=JSON.parse(m.detail.detail).prompt.split(`
`).filter(c=>c)}catch{o=[]}return o});function i(o){De({text:o}),a.success("复制咒语成功、如果有自定义指令、请在左侧禁用自定义指令！")}return(o,n)=>t(l).length?(r(),v("div",oa,[ua,(r(!0),v(F,null,G(t(l),(c,u)=>(r(),v("p",{key:u,class:"text-[12px] mb-1",onClick:h=>i(c)},I(c),9,ia))),128))])):w("",!0)}}),Ve="data:image/png;base64,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",da="/assets/dallAvatar-6100c500.png",ca={class:"flex justify-between w-full"},pa={class:"mr-[10px] flex-shrink-0"},ma=["src"],fa={class:"flex-1 flex flex-col w-full"},va={class:"flex items-center justify-between"},ha={class:"flex items-center h-full"},xa={class:"text-[16px] font-bold"},ba={key:0,class:"w-[68px] h-[24px] rounded-sm flex items-center justify-center text-white bg-[#3388FF] text-[12px] mx-[12px]"},ga={key:0,class:"w-full text-[#1D1C23] dark:text-[#e1ebef] text-[14px] py-[8px] border-b border-[#c0c7d4] dark:border-[#404752]"},ya={key:0,class:"ml-4"},wa={key:2,class:"w-full text-[#1D1C23] dark:text-[#e1ebef] text-[14px] py-[8px] border-b border-[#c0c7d4]"},Aa={key:3,class:"w-full text-[#1D1C23] dark:text-[#e1ebef] text-[14px] py-[8px] border-b border-[#c0c7d4]"},_a={key:4,class:"text-[#79bbff] text-[14px] my-[12px] flex items-center"},ka={key:0,class:"ml-1"},Va={class:"ml-1"},Sa={key:1,class:"relative w-[20px] inline-block"},Ia={key:5,class:"text-[#79bbff] text-[14px] my-[12px] flex items-center"},Ua={key:0,class:"ml-1"},Ba={class:"ml-1"},Ca={key:1,class:"relative w-[20px] inline-block"},Da={class:"flex items-center py-2"},Ea={class:"flex justify-between items-end"},Ta=s("p",{class:"text-[12px]"}," 粘贴在左侧面板使用、可获得相似图片 ",-1),Na=U({__name:"drawHeader",props:{detail:null},emits:["deleteItem","refresh"],setup(e,{emit:m}){const a=e,l=Z(),i=Y(),{isMobile:o}=X(),n=S(()=>l.isLogin),c=b(!1),u=b(!1),h=b(a.detail.seed),p=S(()=>{const{status:_,drawType:g}=a.detail;return _==="IN_PROGRESS"&&g===1}),f=S(()=>{const{progress:_,status:g}=a.detail;return g==="SUCCESS"?!1:(!_||_!=="100%")&&g!=="FAILURE"}),A=S(()=>{const{speed:_,drawType:g,version:B}=a.detail;return g===1?`(${_})`:g===2?`(dall.e${B})`:""}),D=S(()=>{const{drawType:_}=a.detail;return _===1?Ve:_===2?da:Ve}),N=S(()=>{const{drawType:_}=a.detail;return Number(_)===1?"Midjourney Bot":Number(_)===2?"Dall-E Bot":"Midjourney Bot"});S(()=>{const{swapFacePic:_}=a.detail;let g=[];try{g=JSON.parse(_)}catch{g=[]}return g});const L=S(()=>{const{createdAt:_}=a.detail;return _});function E(_){De({text:_}),i.success("复制seed值成功、请在画板中粘贴seed值进行绘画")}async function z(){try{u.value=!0;const _=a.detail.result,g=await Gl({resultId:_});h.value=g.data,u.value=!1}catch{u.value=!1}}function R(){c.value=!1,m("refresh")}return(_,g)=>(r(),v("div",ca,[s("span",pa,[s("img",{src:t(D),class:"w-[40px] h-[40px] rounded-full border"},null,8,ma)]),s("div",fa,[s("div",va,[s("div",ha,[s("span",xa,I(t(N)),1),t(o)?w("",!0):(r(),v("span",ba,"AI机器人")),s("span",{class:H(["text-[12px] text-[#9E9E9E]",t(o)?"ml-2":""])},I(t(L)),3)]),t(n)?(r(),v("span",{key:0,onClick:g[0]||(g[0]=B=>m("deleteItem"))},[d(t(K),{size:"tiny",ghost:""},{icon:x(()=>[d(t(Q),{icon:"ri:delete-bin-line",class:"text-base"})]),_:1})])):w("",!0)]),e.detail.prompt&&!["SWAP_FACE","BLEND"].includes(e.detail.action)?(r(),v("div",ga,[C(I(e.detail.prompt)+" ",1),e.detail.drawType===1&&e.detail.status==="SUCCESS"&&!["DESCRIBE"].includes(e.detail.action)?(r(),v("span",ya,[C(" ["),s("span",null,[C(" seed值: "),e.detail.seed?w("",!0):(r(),V(t(fe),{key:0,trigger:"hover"},{trigger:x(()=>[e.detail.seed?w("",!0):(r(),V(t(K),{key:0,text:"",type:"primary",onClick:g[1]||(g[1]=B=>c.value=!0)},{default:x(()=>[C(" 点击获取 ")]),_:1}))]),default:x(()=>[C(" 使用获取到的seed值粘贴在右侧、可以获得很相似的图片！ ")]),_:1})),e.detail.seed?(r(),v("span",{key:1,class:"cursor-pointer dark:text-primary",onClick:g[2]||(g[2]=B=>E(e.detail.seed))},I(e.detail.seed),1)):w("",!0)]),C(" ]")])):w("",!0)])):w("",!0),["DESCRIBE"].includes(e.detail.action)?(r(),V(ra,{key:1,detail:e.detail},null,8,["detail"])):w("",!0),["SWAP_FACE"].includes(e.detail.action)?(r(),v("div",wa,[s("span",null,I(e.detail.progress==="100%"?"此任务由AI换脸完成......":"正在执行AI换脸任务中......"),1)])):w("",!0),["BLEND"].includes(e.detail.action)?(r(),v("div",Aa,[s("span",null,I(e.detail.progress==="100%"?"此任务由混图功能完成......":"正在执行AI图片混合任务中......"),1)])):w("",!0),e.detail.prompt&&!["SWAP_FACE","BLEND"].includes(e.detail.action)?(r(),v("div",_a,[s("div",null,[C(I(e.detail.promptEn)+" ",1),t(p)?(r(),v("span",ka,"("+I(e.detail.progress||"watting start")+")",1)):w("",!0),C(),s("span",Va,I(t(A)),1),t(f)?(r(),v("span",Sa,[d(t(ae),{class:"absolute left-[20px] top-[-12px] inline-block",size:16})])):w("",!0)])])):w("",!0),["SWAP_FACE","BLEND"].includes(e.detail.action)?(r(),v("div",Ia,[s("div",null,[C(I(e.detail.fullPrompt)+" ",1),t(p)?(r(),v("span",Ua,"("+I(e.detail.progress||"watting start")+")",1)):w("",!0),C(),s("span",Ba,I(t(A)),1),t(f)?(r(),v("span",Ca,[d(t(ae),{class:"absolute left-[20px] top-[-12px] inline-block",size:16})])):w("",!0)])])):w("",!0)]),d(t(ge),{show:c.value,"onUpdate:show":g[3]||(g[3]=B=>c.value=B),style:{width:"400px","max-width":"94vw"},"show-icon":!1,"on-after-enter":z,preset:"dialog",title:"获取seed值"},{default:x(()=>[s("div",Da,[C(" 正在获取中： "),u.value?(r(),V(t(ae),{key:0,size:16,class:"ml-2"})):w("",!0),C(),s("b",null,I(h.value),1)]),s("div",Ea,[Ta,d(t(K),{type:"primary",disabled:u.value,size:"small",onClick:R},{default:x(()=>[C(" 获取完成 ")]),_:1},8,["disabled"])])]),_:1},8,["show"])]))}}),Ra=e=>(Se("data-v-e2326fdd"),e=e(),Ie(),e),$a={class:"flex flex-col justify-center items-center p-3 rounded-md"},za=Ra(()=>s("div",{class:"mt-[18px]"}," 请涂抹你想要重绘的区域并且在下方添加说明！ ",-1)),ja={class:"mt-[20px] w-full"},Pa=U({__name:"regionDraw",props:{drawInfo:null,url:null,detail:null,loading:{type:Boolean}},emits:["submit"],setup(e,{emit:m}){const a=e,l=ie(),i=b(a.detail.prompt||""),o=b(""),n=b(null),c=b(0),u=b(0),h=b(""),p=Y();async function f(){const E=a.url,R=`data:image/png;base64,${(await qe({url:E})).data}`;return o.value=R,await N(R)}function A(E){}async function D(){var g;const E=(g=n.value)==null?void 0:g.offsetWidth;let{width:z,height:R}=a.detail;if(!z||!R){const{w:B,h:M}=await f();z=B,R=M}else f();c.value=E>z?z:E;const _=z/E;u.value=R/_}async function N(E){const z=new Promise((R,_)=>{const g=new Image;g.src=E,g.onload=()=>R({width:g.width,height:g.height}),g.onerror=_});try{const R=await z;return{w:R.width,h:R.height}}catch{}}async function L(){if(!a.loading){if(!h.value)return p.warning("请先涂抹图片后重绘！");if(!i.value)return p.warning("请填写重绘要求！");m("submit",{prompt:i.value,maskBase64:h.value})}}return te(()=>{D()}),(E,z)=>(r(),v("div",$a,[s("div",{ref_key:"contentRef",ref:n,class:"w-full flex justify-center bg-black",style:q({height:`${u.value}px`})},[o.value&&c.value?(r(),V(Ze,{key:0,ref:"canvasRef",modelValue:h.value,"onUpdate:modelValue":z[0]||(z[0]=R=>h.value=R),width:c.value,height:u.value,"update-file-info":A,class:"w-full",src:o.value},null,8,["modelValue","width","height","src"])):w("",!0),o.value?w("",!0):(r(),v("div",{key:1,class:H(["w-full h-full flex justify-center items-center",t(l).theme==="dark"?"loadBg-dark":"loadBg-light"])},[d(t(ae))],2))],4),za,s("div",ja,[d(t(Ae),{value:i.value,"onUpdate:value":z[1]||(z[1]=R=>i.value=R),class:"w-full",loading:e.loading,onKeyup:Ge(L,["enter"])},{suffix:x(()=>[d(t(Q),{icon:"ri:send-plane-fill",class:"text-[20px] cursor-pointer",disabled:!h.value,onClick:L},null,8,["disabled"])]),_:1},8,["value","loading","onKeyup"])])]))}});const Ma=ne(Pa,[["__scopeId","data-v-e2326fdd"]]),La={key:0},Fa=["onClick"],Ha={key:0,class:"relative w-[16px] inline-block"},Oa={class:"flex justify-between items-end"},Ga=s("span",null,"修改zoom值,范围在 1.0~2.0 默认设置为1.7",-1),Qa={class:"w-full"},Ja=U({__name:"buttons",props:{detail:null,loading:{type:Boolean}},emits:["submit"],setup(e,{emit:m}){const a=e,l=Z(),{isMobile:i}=X(),o=b(""),n=b({}),c=b(!1),u=b(!1),h=b({}),p=b(!1),f=Y(),A=S(()=>{const{buttons:y}=a.detail;try{const $=JSON.parse(y);return D($)}catch{return[]}});function D(y){if(y.length===0)return[];if(y.length===13)return[y.slice(0,5),y.slice(5,8),y.slice(8,12)];if(y.length===9)return[y.slice(0,5),y.slice(5,9)];if(y.length===14)return[y.slice(0,5),y.slice(5,9),y.slice(9,13)];if(y.length===5)return[y.slice(0,4)];if(y.length===3)return[y.slice(0,2)];if(y.length===6)return[y.slice(0,6)]}async function N(y,$){if(h.value={actionInfo:y,key:$},y.label==="Custom Zoom"){o.value=`${a.detail.fullPrompt} --zoom 1.7`,c.value=!0;return}if(y.label==="Vary (Region)"){u.value=!0;return}E({})}async function L(){E({modalPrompt:o.value})}async function E({modalPrompt:y="",maskBase64:$=""}){const{actionInfo:k,key:T}=h.value;if(Object.keys(n.value).some(ee=>n.value[ee]))return f.warning("请等待任务提交完成后继续");n.value[T]=!0,p.value=!0;const{customId:j,label:O}=k,{result:W}=a.detail;try{await Ll({customId:j,taskId:W,label:O,modalPrompt:y,maskBase64:$}),o.value="",m("submit"),p.value=!1,c.value=!1,u.value=!1,setTimeout(()=>{n.value[T]=!1,l.getUserInfo()},1e3)}catch{p.value=!1,c.value=!1,u.value=!1,o.value="",h.value={},n.value[T]=!1}}async function z(y){const{prompt:$,maskBase64:k}=y;E({modalPrompt:$,maskBase64:k})}async function R(y){n.value[y]||(n.value[y]=!1)}function _(y){let $=[];try{$=a.detail.operateButtons?JSON.parse(a.detail.operateButtons):[]}catch{$=[]}return $.includes(y)}function g(y){return y}function B(y){return y.includes("upscale_1")?y.replace("upscale_1",""):y}function M(y){if(!y)return"400px";const[$,k]=y.split(":");let T="400";return Number(k)>Number($)&&(T="400px"),Number($)>Number(k)&&(T="800px"),T}return(y,$)=>(r(),v(F,null,[t(A)&&t(A).length?(r(),v("div",La,[(r(!0),v(F,null,G(t(A),(k,T)=>(r(),v("div",{key:T,class:"flex flex-wrap"},[(r(!0),v(F,null,G(k,(j,O)=>{var W,ee;return r(),v("span",{key:O,ref_for:!0,ref:()=>{var he;return R(`loading-${(he=e.detail)==null?void 0:he.result}-${e.detail.id}-${T}-${O}`)},class:H([[n.value[`loading-${(W=e.detail)==null?void 0:W.result}-${e.detail.id}-${T}-${O}`]?"brightness-90":"",_(j.customId)?"bg-[#5A91FC] text-[#fff]":"bg-[#fff] dark:bg-[#2e3246] text-black dark:text-white",t(i)?"px-[14px] py-[5px]  mt-[8px] mr-[6px]":"px-[16px] py-[4px]  mt-[8px] mr-2"],"text-[12px] rounded select-none cursor-pointer hover:brightness-90 active:brightness-95 transition-all whitespace-nowrap"]),onClick:he=>{var _e;return N(j,`loading-${(_e=e.detail)==null?void 0:_e.result}-${e.detail.id}-${T}-${O}`)}},[s("span",{class:H(j.emoji&&j.label?"mr-[6px]":"")},I(B(j.emoji)),3),s("span",null,I(j.label),1),n.value[`loading-${(ee=e.detail)==null?void 0:ee.result}-${e.detail.id}-${T}-${O}`]?(r(),v("span",Ha,[d(t(ae),{class:"absolute left-[8px] top-[-12px] inline-block",size:14})])):w("",!0)],10,Fa)}),128))]))),128))])):w("",!0),d(t(ge),{show:c.value,"onUpdate:show":$[1]||($[1]=k=>c.value=k),style:{width:"600px","max-width":"100vw"},"show-icon":!1,preset:"dialog",title:"自定义变焦"},{default:x(()=>[d(t(Ae),{value:o.value,"onUpdate:value":$[0]||($[0]=k=>o.value=k),type:"textarea",placeholder:"请按要求填写绘制参数",class:"my-5"},null,8,["value"]),s("div",Oa,[Ga,d(t(K),{type:"primary",loading:p.value,disabled:p.value,size:"small",onClick:L},{default:x(()=>[C(I(p.value?"正在提交":"提交绘制"),1)]),_:1},8,["loading","disabled"])])]),_:1},8,["show"]),d(t(ge),{show:u.value,"onUpdate:show":$[2]||($[2]=k=>u.value=k),"show-icon":!1,preset:"dialog",title:"局部重绘编辑",style:q({width:t(i)?"90vw":M(e.detail.scale)})},{default:x(()=>{var k,T,j;return[s("div",Qa,[u.value?(r(),V(Ma,{key:0,loading:p.value,detail:e.detail,"draw-info":(k=h.value)==null?void 0:k.actionInfo,url:((T=e.detail)==null?void 0:T.url)||((j=e.detail)==null?void 0:j.originalImgUrl),onSubmit:z},null,8,["loading","detail","draw-info","url"])):w("",!0)])]}),_:1},8,["show","style"])],64))}}),Ka={class:"ml-[50px]"},Wa=U({__name:"drawItem",props:{detail:null,loading:{type:Boolean}},emits:["submit","deleteItem","refresh"],setup(e,{emit:m}){const{isMobile:a}=X();return(l,i)=>{var o,n;return r(),v("div",{class:H(["bg-[#f6f7fa] dark:bg-[#1f1f1f] flex flex-col pt-[21px] pb-[15px]",[t(a)?"px-2":"px-[12px]"]])},[d(Na,{detail:e.detail,onDeleteItem:i[0]||(i[0]=c=>m("deleteItem",e.detail.id)),onRefresh:i[1]||(i[1]=c=>m("refresh"))},null,8,["detail"]),s("div",Ka,[e.detail.originalImgUrl&&!["DESCRIBE"].includes(e.detail.action)?(r(),V(na,{key:0,"pre-url":e.detail.originalImgUrl||e.detail.thumb,url:e.detail.thumb||e.detail.originalImgUrl,scale:e.detail.scale},null,8,["pre-url","url","scale"])):w("",!0),["DESCRIBE"].includes(e.detail.action)?w("",!0):(r(),V(Ja,{key:1,detail:e.detail,loading:e.loading,onSubmit:i[2]||(i[2]=c=>m("submit"))},null,8,["detail","loading"])),e.detail.drawType===1&&e.detail.buttons==="[]"&&e.detail.requestErrTextTips?(r(),V(ke,{key:2,"err-msg":(o=e.detail)==null?void 0:o.requestErrTextTips},null,8,["err-msg"])):w("",!0),e.detail.drawType===2&&e.detail.requestErrTextTips?(r(),V(ke,{key:3,"err-msg":(n=e.detail)==null?void 0:n.requestErrTextTips},null,8,["err-msg"])):w("",!0)])],2)}}}),qa={id:"footer",class:"w-full flex items-center justify-center"},Za=U({__name:"index",props:{notifyId:null},setup(e){const m=e,a=b([]),l=Z(),{scrollRef:i,scrollToBottom:o,scrollToBottomIfAtBottom:n}=Yt(),c=S(()=>l.isLogin),u=b(!1),h=b(!1),p=Qe(),f=b(null),A=Y(),D=b({page:1,size:10}),N=b(!1),L=b(!1);async function E(k=!1){N.value=k;try{const T=f.value.scrollHeight;h.value=!0;const O=(await zl(D.value)).data.rows;h.value=!1,O.length&&(a.value=O,L.value=O.length===D.value.size,me(()=>{if(!N.value)return;const ee=f.value.scrollHeight-T;i.value.scrollTop=ee,N.value=!1}),u.value&&R(a.value)&&setTimeout(()=>{n()},100),z(a.value)&&setTimeout(()=>{E()},3e3)),O.length||await g(k)}catch{h.value=!1}}function z(k){return k.some(T=>["NOT_START","SUBMITTED","MODAL","IN_PROGRESS"].includes(T.status))}function R(k){return["NOT_START","SUBMITTED","MODAL","IN_PROGRESS"].includes(k[k.length-1].status)}async function _(k){const T=p.warning({title:"删除记录",content:"是否确认删除当前绘制记录、已经启动的任务删除也会扣费！",positiveText:"删除",negativeText:"我再想想",onPositiveClick:async()=>(T.loading=!0,new Promise(async j=>{await Fl({id:k}),E(),A.success("删除绘制记录成功！"),j(!0)}))})}async function g(k=!1){N.value=k;try{h.value=!0;const T=f.value.scrollHeight,j=await $l(D.value);a.value=j.data.rows,h.value=!1,a.value.length>0&&(L.value=a.value.length===D.value.size,me(()=>{if(!N.value)return;const W=f.value.scrollHeight-T;i.value.scrollTop=W,N.value=!1})),D.value.size===10&&a.value.length===0&&setTimeout(()=>{o()},10)}catch{h.value=!1,N.value=!1}}async function B(){await E(),setTimeout(()=>{o(),u.value=!0},10)}async function M(){await E(),o()}te(async()=>{await B(),y()});function y(){const k=document.getElementById("footer");new IntersectionObserver((j,O)=>{j.forEach(W=>{W.isIntersecting&&u.value&&(D.value.size+=10,E(!0))})}).observe(k)}const $=S(()=>h.value&&a.value.length>0);return J(()=>m.notifyId,()=>{E()}),J(()=>c.value,()=>{B()}),(k,T)=>(r(),v("div",{ref_key:"scrollRef",ref:i,class:H([u.value&&!N.value?" scroll-smooth":"","relative h-full overflow-hidden overflow-y-auto"])},[s("div",qa,[t($)?(r(),V(t(ae),{key:0,size:22,class:"mr-3 mb-1 pt-3"})):w("",!0)]),s("div",{ref_key:"containerRef",ref:f,class:"space-y-3"},[(r(!0),v(F,null,G(a.value,j=>(r(),V(Wa,{key:j.id,detail:j,loading:h.value,onRefresh:E,onSubmit:M,onDeleteItem:_},null,8,["detail","loading"]))),128))],512)],2))}}),Ya={class:"bg-white dark:bg-[#1f1f1f] h-full rounded-md flex flex-col"},Xa={class:"flex-1 flex flex-col h-1"},es=U({__name:"index",props:{params:null},setup(e,{expose:m}){const a=e;X();const l=b({prompt:"",autoOptimize:!1,autoTranslate:!0,speed:"fast"}),i=b(0),o=b(!1),n=Z();S(()=>n.isLogin);async function c(){try{o.value=!0;const p={...l.value,...a.params};await Ml(p),o.value=!1,i.value++,n.getUserInfo()}catch{o.value=!1}}function u(){i.value++}m({noticeSubmit:u});function h(p){const{prompt:f,autoOptimize:A,speed:D,autoTranslate:N}=p;f&&(l.value={prompt:f,autoOptimize:A,autoTranslate:N,speed:D},c())}return(p,f)=>(r(),v("div",Ya,[s("main",Xa,[d(Za,{class:"flex-1","notify-id":i.value},null,8,["notify-id"])]),d(qt,{params:e.params,class:"overflow-hidden","notify-id":i.value,"submit-loading":o.value,onUpdate:u,onSubmit:h},null,8,["params","notify-id","submit-loading"])]))}}),ls={class:"h-full dark:bg-[#000] transition-all"},cs=U({__name:"index",setup(e){const m=ie(),{isMobile:a}=X(),l=S(()=>m.siderDrawCollapsed),i=b({}),o=b(null),n=S(()=>["h-full","dark:bg-[#000] bg-[#dce3f1]"]);function c(p){i.value=p}const u=S(()=>a.value?["rounded-none","shadow-none"]:["rounded-md","shadow-md","dark:border-neutral-800"]);function h(){o.value&&o.value.noticeSubmit()}return(p,f)=>(r(),v("div",ls,[s("div",{class:H(["h-full overflow-hidden",t(u)])},[d(t(Je),{class:H(["z-40 transition",t(n)]),"has-sider":"","content-style":{backgroundColor:t(m).theme==="dark"?"#000":"#dce3f1"}},{default:x(()=>[d(Tt,{onNotice:c,onSubmitNotice:h}),s("div",{class:H(["bg-[#dce3f1] dark:bg-[#000] transition-all",[!t(a)&&!t(l)?"translate-x-[350px] w-[calc(100%-362px)]":"w-full translate-x-0",t(a)?"px-0":"ml-[12px]"]])},[d(es,{ref_key:"contentRef",ref:o,params:i.value},null,8,["params"])],2)]),_:1},8,["class","content-style"])],2)]))}});export{cs as default};
