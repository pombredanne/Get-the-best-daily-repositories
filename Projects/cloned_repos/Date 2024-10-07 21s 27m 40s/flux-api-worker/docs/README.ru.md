# Flux-API-Worker - README üìòüé®ü§ñ

[English](../README.md) | [ÁÆÄ‰Ωì‰∏≠Êñá](./README.zh-cn.md) | [ÁπÅÈ´î‰∏≠Êñá](./README.zh-hant.md) | [Êó•Êú¨Ë™û](./README.ja.md) | [Espa√±ol](./README.es.md) | [Fran√ßais](./README.fr.md) | [–†—É—Å—Å–∫–∏–π](./README.ru.md) | [Deutsch](./README.de.md)

## –í–≤–µ–¥–µ–Ω–∏–µ üåüüí°

Flux-API-Worker - —ç—Ç–æ —Å–µ—Ä–≤–∏—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –ø–æ–º–æ—â—å—é –ò–ò, —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –Ω–∞ Cloudflare Worker. –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–æ–¥–µ–ª—å Flux, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º—É—é Cloudflare, –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π API-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤. –≠—Ç–æ—Ç —Å–µ—Ä–≤–∏—Å –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –º–æ—â–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –ø–æ–º–æ—â—å—é –ò–ò. ‚ú®üñºÔ∏èüöÄ

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ üöÄüåà

- üé® –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø–æ–¥—Å–∫–∞–∑–æ–∫ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- üåê –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- üìê –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ –∏ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–π —Å—Ç–æ—Ä–æ–Ω –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- üíæ –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Cloudflare KV
- üîÑ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ—Ç–æ–∫–æ–≤—ã—Ö –∏ –Ω–µ–ø–æ—Ç–æ–∫–æ–≤—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
- üîí –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞ –≤—ã–≤–æ–¥–∞
- üåç –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Cross-Origin Resource Sharing (CORS)

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç üèÉ‚Äç‚ôÇÔ∏èüí®

### –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ Cloudflare Dashboard üñ•Ô∏èüõ†Ô∏è

1. –í–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ—é —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å Cloudflare –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É Workers. üë®‚Äçüíªüë©‚Äçüíª
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–°–æ–∑–¥–∞—Ç—å —Å–µ—Ä–≤–∏—Å". üÜï
3. –ù–∞–∑–æ–≤–∏—Ç–µ –≤–∞—à Worker, –Ω–∞–ø—Ä–∏–º–µ—Ä, "flux-api". ‚úèÔ∏è
4. –í—Å—Ç–∞–≤—å—Ç–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –∫–æ–¥ Worker –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä. üìã
5. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å". üöÄ

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è ‚öôÔ∏èüîß

–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ Worker –Ω–∞–π–¥–∏—Ç–µ —Ä–∞–∑–¥–µ–ª "–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è" –∏ –¥–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

## –°–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è üìãüîë

| –ò–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π | –û–ø–∏—Å–∞–Ω–∏–µ | –¢–∏–ø | –ü—Ä–∏–º–µ—Ä | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|----------------|----------|-----|--------|--------------|
| `API_KEY` | –ö–ª—é—á –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ API üîê | –°—Ç—Ä–æ–∫–∞ | `"–≤–∞—à-—Å–ª–æ–∂–Ω—ã–π-–∫–ª—é—á-api"` | - |
| `CF_ACCOUNT_ID` | ID –∞–∫–∫–∞—É–Ω—Ç–∞ Cloudflare üÜî | –°—Ç—Ä–æ–∫–∞ | `"1a2b3c4d5e6f7g8h9i0j"` | - |
| `CF_API_TOKEN` | –¢–æ–∫–µ–Ω API Cloudflare üéüÔ∏è | –°—Ç—Ä–æ–∫–∞ | `"–≤–∞—à-—Ç–æ–∫–µ–Ω-api-cloudflare"` | - |
| `PROMPT_OPTIMIZATION` | –í–∫–ª—é—á–∏—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –∑–∞–ø—Ä–æ—Å–∞ üåê | –°—Ç—Ä–æ–∫–∞ | `"true"` –∏–ª–∏ `"false"` | - |
| `EXTERNAL_API_BASE` | –ë–∞–∑–æ–≤—ã–π URL –≤–Ω–µ—à–Ω–µ–≥–æ API üîó | –°—Ç—Ä–æ–∫–∞ | `"https://api.external-service.com"` | - |
| `EXTERNAL_MODEL` | –ù–∞–∑–≤–∞–Ω–∏–µ –≤–Ω–µ—à–Ω–µ–π –º–æ–¥–µ–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ ü§ñ | –°—Ç—Ä–æ–∫–∞ | `"gpt-3.5-turbo"` | - |
| `EXTERNAL_API_KEY` | –ö–ª—é—á –¥–æ—Å—Ç—É–ø–∞ –∫ –≤–Ω–µ—à–Ω–µ–º—É API üóùÔ∏è | –°—Ç—Ä–æ–∫–∞ | `"–≤–∞—à-–≤–Ω–µ—à–Ω–∏–π-–∫–ª—é—á-api"` | - |
| `FLUX_NUM_STEPS` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ –º–æ–¥–µ–ª–∏ Flux üö∂ | –¶–µ–ª–æ–µ —á–∏—Å–ª–æ | `"4"` | 4 |
| `IMAGE_EXPIRATION` | –í—Ä–µ–º—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ KV (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö) ‚è≥ | –¶–µ–ª–æ–µ —á–∏—Å–ª–æ | `"1800"` | 1800 |

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ —ç—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è Cloudflare Worker. –î–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –µ—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ —Ç—Ä–µ–±—É—é—Ç—Å—è, –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. üîß‚úÖ

> –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –î–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–ª–æ–∂–Ω—É—é —Å—Ç—Ä–æ–∫—É –¥–ª—è `API_KEY`. –û–Ω–∞ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ –≤—ã–∑–æ–≤–æ–≤ API. üîíüõ°Ô∏è

### –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω KV üóÑÔ∏èüì¶

1. –í –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Cloudflare –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É "Workers". üñ•Ô∏è
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "KV". üìë
3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏–º–µ–Ω –∏ –Ω–∞–∑–æ–≤–∏—Ç–µ –µ–≥–æ "FLUX_CF_KV". üÜï
4. –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Worker –ø—Ä–∏–≤—è–∂–∏—Ç–µ —ç—Ç–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏–º–µ–Ω KV –∫ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `FLUX_CF_KV`. üîó

## –ö–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏ API –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å üåêüõ†Ô∏è

### 1. –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è üëã

–ü—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ –∫–æ—Ä–Ω–µ–≤–æ–º—É –ø—É—Ç–∏ Worker (`https://<–∏–º—è_–≤–∞—à–µ–≥–æ_worker>.<–≤–∞—à_–ø–æ–¥–¥–æ–º–µ–Ω>.workers.dev/`) –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—â–∞—è —Ä–∞–±–æ—Ç—É API-—Å–µ—Ä–≤–∏—Å–∞. ‚úÖüè†

### 2. –ö–æ–Ω–µ—á–Ω–∞—è —Ç–æ—á–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —á–∞—Ç–∞ üí¨

–û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω–µ—á–Ω–∞—è —Ç–æ—á–∫–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:
```
https://<–∏–º—è_–≤–∞—à–µ–≥–æ_worker>.<–≤–∞—à_–ø–æ–¥–¥–æ–º–µ–Ω>.workers.dev/v1/chat/completions
```
üé®‚ú®

### 3. –ö–æ–Ω–µ—á–Ω–∞—è —Ç–æ—á–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–æ–¥–µ–ª–∏ ‚ÑπÔ∏è

–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–æ–¥–µ–ª—è—Ö:
```
https://<–∏–º—è_–≤–∞—à–µ–≥–æ_worker>.<–≤–∞—à_–ø–æ–¥–¥–æ–º–µ–Ω>.workers.dev/v1/models
```
–≠—Ç–∞ –∫–æ–Ω–µ—á–Ω–∞—è —Ç–æ—á–∫–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–π –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –º–æ–¥–µ–ª–∏ Flux. ü§ñüìä

### 4. –ö–æ–Ω–µ—á–Ω–∞—è —Ç–æ—á–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è üñºÔ∏è

–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:
```
https://<–∏–º—è_–≤–∞—à–µ–≥–æ_worker>.<–≤–∞—à_–ø–æ–¥–¥–æ–º–µ–Ω>.workers.dev/image/{–∫–ª—é—á_–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è}
```
üì•üé≠

## –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é üìñüß≠

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è üñºÔ∏èüé®

–û—Ç–ø—Ä–∞–≤—å—Ç–µ POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ –∫–æ–Ω–µ—á–Ω—É—é —Ç–æ—á–∫—É –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —á–∞—Ç–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ñ–æ—Ä–º–∞—Ç–µ:

```json
{
  "messages": [
    {
      "role": "user",
      "content": "–ú–∏–ª—ã–π –∫–æ—Ç–µ–Ω–æ–∫ 3:2"
    }
  ],
  "stream": false
}
```

–ó–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –¥–æ–ª–∂–Ω—ã –≤–∫–ª—é—á–∞—Ç—å:

```
Authorization: Bearer –í–ê–®_–ö–õ–Æ–ß_API
Content-Type: application/json
```

> –í–∞–∂–Ω–æ: –ó–∞–º–µ–Ω–∏—Ç–µ `–í–ê–®_–ö–õ–Æ–ß_API` –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏–µ `API_KEY`, –∫–æ—Ç–æ—Ä–æ–µ –≤—ã —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è. üîëüîÑ

### –ü–æ—Ç–æ–∫–æ–≤—ã–π –æ—Ç–≤–µ—Ç üåäüì°

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –ø–æ—Ç–æ–∫–æ–≤—ã–π –æ—Ç–≤–µ—Ç, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä `stream` –≤ –∑–Ω–∞—á–µ–Ω–∏–µ `true`:

```json
{
  "messages": [
    {
      "role": "user",
      "content": "–ú–∏–ª—ã–π –∫–æ—Ç–µ–Ω–æ–∫ 3:2"
    }
  ],
  "stream": true
}
```

–ü–æ—Ç–æ–∫–æ–≤—ã–π –æ—Ç–≤–µ—Ç –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–µ–Ω –≤ —Ñ–æ—Ä–º–∞—Ç–µ Server-Sent Events (SSE), —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. ‚ö°üîÑ

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ä–∞–∑–º–µ—Ä—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π üìèüñºÔ∏è

Flux-API-Worker –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –∏ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å—Ç–æ—Ä–æ–Ω –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:

- 1:1 (1024x1024) - —Ä–∞–∑–º–µ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é üü¶
- 1:2 (512x1024) üì±
- 3:2 (768x512) üñºÔ∏è
- 3:4 (768x1024) üì±
- 16:9 (1024x576) üñ•Ô∏è
- 9:16 (576x1024) üì±

–ß—Ç–æ–±—ã —É–∫–∞–∑–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ä–∞–∑–º–µ—Ä, –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤—å—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω –ø–æ—Å–ª–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```
"–ú–∏–ª—ã–π –∫–æ—Ç–µ–Ω–æ–∫ 16:9"
```

–ï—Å–ª–∏ —Ä–∞–∑–º–µ—Ä –Ω–µ —É–∫–∞–∑–∞–Ω, —Å–∏—Å—Ç–µ–º–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 1:1 (1024x1024). üéõÔ∏èüîß

### –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Cross-Origin Resource Sharing (CORS) üåçüîì

Flux-API-Worker –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç CORS, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ API –∏–∑ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –¥–æ–º–µ–Ω–∞—Ö. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞–ø—Ä—è–º—É—é –≤—ã–∑—ã–≤–∞—Ç—å API –∏–∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –Ω–∞ JavaScript –±–µ–∑ –ø—Ä–æ–±–ª–µ–º —Å –∫—Ä–æ—Å—Å-–¥–æ–º–µ–Ω–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏. üîóüö´üöß

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö üîóüîå

Flux-API-Worker –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —Ç–∞–∫–∏–µ –∫–∞–∫ NextWeb, ChatBox –∏ –¥—Ä—É–≥–∏–µ. –ü—Ä–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –≤ —ç—Ç–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö:

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∞–¥—Ä–µ—Å API –Ω–∞ URL –≤–∞—à–µ–≥–æ Worker (–∫–æ–Ω–µ—á–Ω–∞—è —Ç–æ—á–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —á–∞—Ç–∞). üîó
2. –í–≤–µ–¥–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –≤–∞–º–∏ API KEY. üîë
3. –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É—á–∏—Ç—ã–≤–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ System Message, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º, —Ç–∞–∫ –∫–∞–∫ Flux-API-Worker –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ System Message. üí¨üö´

> –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: Flux-API-Worker —É–¥–∞–ª–∏–ª —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –∫–∞–∂–¥—ã–π –≤—ã–∑–æ–≤ –±—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤–æ–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ. üÜïüñºÔ∏è

### –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ üì§üìä

–ü—Ä–∏–º–µ—Ä –Ω–µ–ø–æ—Ç–æ–∫–æ–≤–æ–≥–æ –æ—Ç–≤–µ—Ç–∞:

```json
{
  "id": "chatcmpl-1234567890",
  "created": 1677649420,
  "model": "@cf/black-forest-labs/flux-1-schnell",
  "object": "chat.completion",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "üé® –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞: –ú–∏–ª—ã–π –∫–æ—Ç–µ–Ω–æ–∫ 3:2\nüí¨ –ú–æ–¥–µ–ª—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ–¥—Å–∫–∞–∑–∫–∏: Original Prompt\nüåê –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å: –ú–∏–ª—ã–π –∫–æ—Ç–µ–Ω–æ–∫\nüìê –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: 768x512\nüåü –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ!\n–í–æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç:\n\n![–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ](https://url-–≤–∞—à–µ–≥–æ-worker.workers.dev/image/12345)"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 20,
    "completion_tokens": 100,
    "total_tokens": 120
  }
}
```

## –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è ‚ö†Ô∏èüö®

- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã. ‚úÖüîß
- API-–∫–ª—é—á –¥–æ–ª–∂–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞—Ç—å—Å—è –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º –∫–æ–¥–µ. üîíüôà
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ KV –∏–º–µ—é—Ç —Å—Ä–æ–∫ —Ö—Ä–∞–Ω–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 30 –º–∏–Ω—É—Ç), —Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –≤–∞–∂–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. ‚è≥üíæ
- –ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤–∫–ª—é—á–µ–Ω–∞, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–Ω–µ—à–Ω–µ–µ API –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ. üåêüîß
- –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –ø–æ—Ç–æ–∫–æ–≤–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à –∫–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å Server-Sent Events. üåäüì°

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫ üîßüöë

1. –ü—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –æ—à–∏–±–∫–∏ –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API-–∫–ª—é—á–∞. üîë‚ùì
2. –ï—Å–ª–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ —É–¥–∞–µ—Ç—Å—è, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–æ–∫–µ–Ω API Cloudflare –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è. üéüÔ∏èüîç
3. –ï—Å–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `PROMPT_OPTIMIZATION` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞ 'true' –∏ –≤–Ω–µ—à–Ω–µ–µ API –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ. üåêüîß
4. –ï—Å–ª–∏ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –æ—à–∏–±–∫—É 404, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–±—Ä–∞—â–∞–µ—Ç–µ—Å—å –∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É –ø—É—Ç–∏ –∫–æ–Ω–µ—á–Ω–æ–π —Ç–æ—á–∫–∏. üîçüö∑
5. –î–ª—è –¥—Ä—É–≥–∏—Ö –æ—à–∏–±–æ–∫ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Worker –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ—à–∏–±–∫–µ. üìãüî¨

## –î–∞–ª—å–Ω–µ–π—à–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ üõ†Ô∏èüé®

–í—ã –º–æ–∂–µ—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å API, –∏–∑–º–µ–Ω–∏–≤ –∫–æ–¥ Worker, –Ω–∞–ø—Ä–∏–º–µ—Ä:

- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ä–∞–∑–º–µ—Ä—ã –∏ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å—Ç–æ—Ä–æ–Ω –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π üìè‚úÇÔ∏è
- –ò–∑–º–µ–Ω–∏—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ —Å–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ–¥—Å–∫–∞–∑–æ–∫ üí¨üîÑ
- –î–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –∏ –≤–µ–¥–µ–Ω–∏—è –∂—É—Ä–Ω–∞–ª–∞ üö®üìä
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏–ª–∏ –¥—Ä—É–≥–∏–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ üõ°Ô∏è‚è±Ô∏è

–Ø –Ω–∞–¥–µ—é—Å—å, —á—Ç–æ —ç—Ç–æ—Ç README –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –±—ã—Å—Ç—Ä–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Flux-API-Worker. –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –Ω—É–∂–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–º–æ—â—å, –Ω–µ —Å—Ç–µ—Å–Ω—è–π—Ç–µ—Å—å –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫–æ –º–Ω–µ. üíåüë®‚Äçüíªüë©‚Äçüíª

–ï—Å–ª–∏ –≤—ã —Å—á–∏—Ç–∞–µ—Ç–µ, —á—Ç–æ —ç—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –±—ã–ª –≤–∞–º –ø–æ–ª–µ–∑–µ–Ω, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ—Å—Ç–∞–≤—å—Ç–µ –µ–º—É –∑–≤–µ–∑–¥—É. ‚≠ê‚≠ê‚≠ê –°–ø–∞—Å–∏–±–æ!
